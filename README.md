# ç‰¹æ€§

- ğŸ” æŠ€æœ¯æ ˆï¼š`React & TypeScript & Redux`ï¼Œç°ä»£å‰ç«¯å·¥ç¨‹åŒ–å¼€å‘æ¨¡å¼ï¼Œè®©ä½ ä»å¼€å‘ `SPA` æ— ç¼åˆ‡æ¢åˆ° `chrome` æ‰©å±•å¼€å‘
- ğŸ”¥ çƒ­æ›´æ–°ï¼Œè‡ªåŠ¨é‡è½½ `content scripts`ï¼Œè‡ªåŠ¨åŒ–åˆ·æ–°æ³¨å…¥é¡µé¢ï¼Œå¼€å‘ä½“éªŒä¸èˆ¬é¡ºæ»‘
- âš’ï¸ â€‹ è‡ªå¸¦ `webpack` ç›¸å…³æ‰“åŒ…ä¼˜åŒ–é…ç½®ï¼Œé›†æˆè‹¥å¹²æ’ä»¶ï¼Œä¼˜åŒ–å¼€å‘æ„å»ºæ‰“åŒ…æµç¨‹ã€‚

# æ¶æ„è®¾è®¡

![image.png](https://intranetproxy.alipay.com/skylark/lark/0/2020/png/284871/1593342840509-c94a1883-a45f-4a56-86e4-f0fd7c2b5b56.png)
ç»“æ„ç›®å½•ï¼š

```
	.
	â”œâ”€â”€ extension
	â”œâ”€â”€ public
    â”œâ”€â”€ server
	â””â”€â”€ src
	 Â Â  â”œâ”€â”€ background
	 Â Â  â”œâ”€â”€ contents/all
        â”œâ”€â”€ i18n
        â”œâ”€â”€ inject
        â”œâ”€â”€ options
        â”œâ”€â”€ popup
	 Â Â      â”œâ”€â”€ page
	 Â Â      â”œâ”€â”€ store
            â””â”€â”€ index.tsx
        â”œâ”€â”€ manifest.dev.json
	 Â Â  â””â”€â”€ manifest.prod.json

```

#### extension

æ‰“åŒ…å‡ºæ¥çš„ æ‰©å±•åŒ… æ–‡ä»¶å¤¹ï¼Œå¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨æ‰©å±•å¼•å…¥ä½¿ç”¨ã€‚

#### public

å…¬å…±èµ„æºæ–‡ä»¶å¤¹ï¼Œå…¶ä¸­çš„æ–‡ä»¶æ„å»ºæ—¶ä¼šè¢«æ‰“åŒ…å…¥ `extension` æ–‡ä»¶å¤¹ä¸­ï¼Œå¯ä»¥åœ¨ä»£ç ä¸­å¼•ç”¨èµ„æºæ–‡ä»¶ã€‚

#### server

ä¸€èˆ¬ä¸å¿…å…³æ³¨ï¼Œwebpack server æ–‡ä»¶å¤¹ï¼Œå…¶ä¸­æœ‰ `webpack` é…ç½®ï¼Œå’Œç›¸å…³çƒ­æ›´æ–°å°è£…ï¼Œæå‡å¼€å‘ä½“éªŒã€‚

#### background

æ’ä»¶çš„ background é¡µï¼Œæ„å»ºæ—¶å€™ä¼šæ‰“åŒ…æˆ background.js

#### contents

é¡µé¢æ³¨å…¥è„šæœ¬ï¼Œå¯ä»¥åœ¨ `manifest` é…ç½®æ³¨å…¥é¡µé¢

#### i18n

å›½é™…åŒ–ï¼Œå·²ç»é›†æˆäº†ç¾æœèï¼Œå¯ä»¥åœ¨ `src/background/utils.ts` ä¸­åˆ‡æ¢ç¾æœèçš„ CDN åœ°å€ï¼Œå¹¶ä¸”å·²ç»åœ¨ popup å†™å¥½ demoã€‚

#### inject

æ³¨å…¥ js è„šæœ¬ï¼Œå®Œå…¨æ³¨å…¥è¿›é¡µé¢çš„ js æ®µ

#### optionsï¼Œpopup

æ’ä»¶é¡µé¢ï¼Œå¯ä»¥ `React SPA` æ–¹å¼å¼€å‘ï¼ŒæŠ€æœ¯æ ˆæ˜¯ react + redux ï¼Œå·²ç»é›†æˆå¥½è·¯ç”±ï¼Œå¹¶å†™äº†ä¸ªå°ä¾‹å­~

#### manifest.json

é…ç½® `JSON`ï¼Œè°·æ­Œæ’ä»¶çš„é…ç½®æ–‡ä»¶ï¼Œç›¸å…³é…ç½®å¯ä»¥æŸ¥çœ‹ [LINK](https://developer.chrome.com/extensions/manifest)

# æ ¸å¿ƒåŠŸèƒ½

### ä¼˜åŒ–

- åˆç†çš„é¡¹ç›®ç»“æ„è®¾è®¡ï¼Œè®©ä½ å³ä½¿æ²¡æ²¡æœ‰æ¥è§¦è¿‡æ’ä»¶å¼€å‘ä¹Ÿèƒ½ç›´æ¥ä¸Šæ‰‹
- é›†æˆäº†è‹¥å¹²ä¼˜ç§€çš„ç¤¾åŒº webpack æ‰“åŒ…æ’ä»¶å’Œé…ç½®é¡¹ï¼Œæä¾›æ‰“åŒ…çš„ä¼˜åŒ–ï¼Œä¸ç”¨æ‹…å¿ƒæ‰“åŒ…ä½“ç§¯é—®é¢˜
- é›†æˆäº†é›†å›¢å†…éƒ¨çš„æŠ€æœ¯ä½“ç³»ï¼Œä»¥åŠå¤šä¸ªå¸¸ç”¨å·¥å…·åº“ï¼Œæ–¹ä¾¿ä½¿ç”¨

### çƒ­æ›´æ–°

Ken ä¼šæ‰«æ `src/contents` æ–‡ä»¶å¤¹å¹¶å®ç°æ³¨å…¥ä»£ç çš„çƒ­æ›´æ–°ï¼Œä¹Ÿä¼šçƒ­æ›´æ–° popup ç­‰é¡µé¢ï¼Œå¹¶æä¾› webpack çš„ devserver æ¥è¿›è¡Œ react ç­‰ä»£ç ç›¸å…³çš„çƒ­æ›´æ–°ï¼Œ All Hot Reloadï¼

### content scripts

Ken ä¼šè‡ªåŠ¨å°† contents ä¸‹çš„æ–‡ä»¶å¤¹æ‰“åŒ…æˆè‹¥å¹² jsï¼Œé€šè¿‡é…ç½® manifest æ¥å®ç°å¤šé¡µé¢åˆ†åˆ«æ³¨å…¥

å¦‚æœ contents ä¸‹æœ‰ä¸ª `discuss` æ–‡ä»¶å¤¹ä¾‹å­ï¼š

```javascript
"content_scripts": [
    {
        "matches": ["https://www.example.com/discuss*"],
        "css": ["css/discuss.css"],
        "js": ["js/discuss.js"]
    }
],
```

# å¼€å§‹

```shell
git clone https://github.com/Knove/Ken.git
```

# è°ƒè¯•

å¼€å¯è°ƒè¯•æœåŠ¡ï¼š

```shell
tnpm start
```

1. åœ¨è°·æ­Œæµè§ˆå™¨ `chrome://extensions/`(æ‰©å±•ç¨‹åº) é¡µé¢ï¼Œå³ä¸Šè§’æ‰“å¼€ `å¼€å‘è€…æ¨¡å¼`
2. å·¦ä¸Šè§’é€‰æ‹© `åŠ è½½å·²è§£å‹çš„æ‰©å±•ç¨‹åº` ï¼Œé€‰æ‹©é¡¹ç›®å†…çš„ `extension` æ–‡ä»¶å¤¹

![image.png](https://ata2-img.oss-cn-zhangjiakou.aliyuncs.com/bcff993afb588b179af75a26b1db8c04.png)

`Enjoy itï¼` è¶…çˆ½çš„å¼€å‘ä½“éªŒ

# å‘å¸ƒ

æ‰“å‡ºç”Ÿäº§åŒ…

```shell
tnpm run build
```

åœ¨è°·æ­Œæµè§ˆå™¨å¼€å‘è€…å¸‚åœº [å¼€å‘è€…åå°](https://chrome.google.com/webstore/devconsole) é¡µé¢ï¼Œä¸Šä¼ æ‰“å‡ºçš„ç”Ÿäº§åŒ…

![image.png](https://ata2-img.oss-cn-zhangjiakou.aliyuncs.com/1bf3e43c0c5e30dbcedc5748bff2c11d.png)

# æ€»ç»“

æ¨¡æ¿å°±è¦åŠ›æ±‚å¹²å‡€å¥½ç”¨ï¼Œå¹²å‡€å°±æ˜¯éšèµ·éšå¼€ `cover` å¤§éƒ¨åˆ†çš„åœºæ™¯åˆä¸å†—ä½™ã€‚å¥½ç”¨å°±æ˜¯å¼€å‘ä½“éªŒæ»¡åˆ†ï¼Œä¹Ÿæ— éœ€å…³æ³¨æ‰“åŒ…ã€‚